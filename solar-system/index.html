<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OP022 / OP023 — Multi-Planet Pipeline (Methods, Repro, Results)</title>
<style>
  :root{
    --bg:#0b0f14; --fg:#e8eef5; --muted:#a9b5c2; --line:#243241; --accent:#7bdcff; --code:#0e141b;
    --card:#0f1520; --good:#22c55e; --warn:#f59e0b;
  }
  html,body{background:var(--bg); color:var(--fg); font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial; line-height:1.55; margin:0; padding:0}
  .wrap{max-width:1100px; margin:0 auto; padding:28px 16px}
  h1{font-size:1.8rem; margin:0 0 8px}
  h2{font-size:1.3rem; margin:28px 0 10px}
  h3{font-size:1.05rem; margin:18px 0 8px}
  p.muted, .muted{color:var(--muted)}
  a{color:var(--accent); text-decoration:none}
  a:hover{text-decoration:underline}
  code, pre{background:var(--code); color:var(--fg)}
  code{padding:0.15em 0.35em; border-radius:6px}
  pre{padding:12px 14px; border-radius:12px; overflow:auto; border:1px solid var(--line)}
  .card{background:var(--card); border:1px solid var(--line); border-radius:14px; padding:16px 16px 14px; margin:14px 0}
  table{width:100%; border-collapse:collapse; margin:10px 0 4px}
  th,td{border-bottom:1px solid var(--line); padding:8px 10px; text-align:left; vertical-align:top}
  th{color:#fff}
  .grid{display:grid; gap:14px}
  @media(min-width:900px){ .grid.cols-2{grid-template-columns:1fr 1fr} }
  .note{border-left:3px solid var(--accent); padding-left:10px}
  .pill{display:inline-block; padding:2px 8px; border:1px solid var(--line); border-radius:999px; font-size:12px; color:var(--muted)}
  .list-tight li{margin:6px 0}
  .small{font-size:0.95em}
  .center{display:flex; justify-content:center; align-items:center}
  details summary{cursor:pointer; color:var(--accent)}
  .iframe-box{border:1px solid var(--line); border-radius:12px; background:var(--card); overflow:hidden}
  .warn{color:#f59e0b}
</style>
</head>
<body>
<div class="wrap">

  <header class="card">
    <h1>OP022 / OP023 — Multi-Planet Pipeline</h1>
    <p class="muted">Deterministic analysis of perihelion-relative timing using a standardized state vector <code>Ψ(t)</code> from JPL Horizons. This page documents data, methods, commands, and a cross-planet results summary.</p>
    <p class="pill">Data source: JPL Horizons (DE441). Heliocentric, Ecliptic of J2000.0. Daily cadence.</p>
  </header>

  <!-- 1) Executive summary -->
  <section class="card" id="exec-summary">
    <h2>Executive summary</h2>
    <p>Using daily DE441 ephemerides, OP023 peaks from a standardized 17-D state vector were matched to perihelia across nine targets. Matched coverage is 1.000 for all bodies. Dispersion σ by planet: Mercury 0.282 d, Venus 0.383 d, Earth 21.141 d, Mars 0.943 d, Jupiter 1.221 d, Saturn 157.919 d, Uranus 177.163 d (PCA mode), Neptune 842.011 d, Pluto barycenter 16.197 d. Wrapped phase fractions φ (Δt/P) are stable per body: Mercury +0.3989, Venus −0.2144, Earth +0.0415, Mars −0.1332, Jupiter +0.2153, Saturn +0.1815, Uranus −0.0830, Neptune +0.1198, Pluto barycenter +0.2082.</p>
  </section>

  <!-- 1a) φ at a glance (inline SVG, no dependencies) -->
  <section class="card" id="phi-glance">
    <h2>Phase offsets φ at a glance</h2>
    <div class="small muted">φ is Δt/P wrapped to (−0.5, 0.5]. Bars to the right are positive (peak after perihelion); left are negative.</div>
    <div class="center" aria-hidden="true" style="margin-top:8px">
      <!-- Simple zero-centered horizontal bars -->
      <svg viewBox="0 0 820 260" width="100%" role="img">
        <defs>
          <style><![CDATA[
            .axis{stroke:#243241;stroke-width:1}
            .label{fill:#a9b5c2;font-size:12px}
            .barpos{fill:#22c55e}
            .barneg{fill:#f59e0b}
          ]]></style>
        </defs>
        <!-- Axis -->
        <line x1="410" y1="20" x2="410" y2="240" class="axis"/>
        <!-- Helper ticks -->
        <text x="410" y="12" class="label" text-anchor="middle">0</text>
        <text x="690" y="12" class="label" text-anchor="middle">+0.5</text>
        <text x="130" y="12" class="label" text-anchor="middle">−0.5</text>
        <!-- Rows -->
        <!-- Helper function: x = 410 + 560 * φ (scale 560px for full 1.0 span) -->
        <!-- Mercury +0.3989 -->
        <text x="12" y="44" class="label">Mercury</text>
        <rect x="410" y="32" width="223" height="18" class="barpos"/>
        <text x="640" y="45" class="label">+0.3989</text>
        <!-- Venus −0.2144 -->
        <text x="12" y="74" class="label">Venus</text>
        <rect x="290" y="62" width="120" height="18" class="barneg"/>
        <text x="260" y="75" class="label">−0.2144</text>
        <!-- Earth +0.0415 -->
        <text x="12" y="104" class="label">Earth</text>
        <rect x="433" y="92" width="23" height="18" class="barpos"/>
        <text x="464" y="105" class="label">+0.0415</text>
        <!-- Mars −0.1332 -->
        <text x="12" y="134" class="label">Mars</text>
        <rect x="335" y="122" width="75" height="18" class="barneg"/>
        <text x="320" y="135" class="label">−0.1332</text>
        <!-- Jupiter +0.2153 -->
        <text x="12" y="164" class="label">Jupiter</text>
        <rect x="530" y="152" width="121" height="18" class="barpos"/>
        <text x="660" y="165" class="label">+0.2153</text>
        <!-- Saturn +0.1815 -->
        <text x="12" y="194" class="label">Saturn</text>
        <rect x="511" y="182" width="102" height="18" class="barpos"/>
        <text x="630" y="195" class="label">+0.1815</text>
        <!-- Uranus −0.0830 -->
        <text x="12" y="224" class="label">Uranus</text>
        <rect x="363" y="212" width="47" height="18" class="barneg"/>
        <text x="350" y="225" class="label">−0.0830</text>
        <!-- Neptune +0.1198 -->
        <text x="12" y="224" class="label">Neptune</text>
        <rect x="477" y="212" width="67" height="18" class="barpos"/>
        <text x="640" y="225" class="label">+0.1198</text>
        <!-- Pluto barycenter +0.2082 -->
        <text x="12" y="254" class="label">Pluto barycenter</text>
        <rect x="527" y="242" width="117" height="18" class="barpos"/>
        <text x="655" y="255" class="label">+0.2082</text>
      </svg>
    </div>
  </section>

  <!-- 2) What Δt means -->
  <section class="card" id="what-dt-means">
    <h2>What Δt means</h2>
    <p><strong>Definition.</strong> For each perihelion time <em>t<sub>peri</sub></em>, let <em>t<sub>peak</sub></em> be the nearest OP023 peak in the match window. We define <code>Δt = t_peak − t_peri</code> (days). Positive Δt means the OP023 peak occurs after perihelion; negative Δt means before.</p>
    <p><strong>Phase normalization.</strong> To compare across different orbital periods <em>P</em>, we use <code>φ = wrap(Δt / P)</code> mapped to <code>(−0.5, 0.5]</code>. Values near 0 indicate peaks cluster close to perihelion; non-zero φ indicates a stable phase offset.</p>
    <div class="center small" aria-hidden="true">
      <svg width="720" height="120" viewBox="0 0 720 120" role="img">
        <rect x="0" y="0" width="720" height="120" fill="none" stroke="#243241"/>
        <line x1="60" x2="660" y1="80" y2="80" stroke="#a9b5c2" stroke-width="1"/>
        <circle cx="210" cy="80" r="5" fill="#22c55e"/>
        <text x="210" y="100" fill="#a9b5c2" font-size="12" text-anchor="middle">perihelion</text>
        <circle cx="370" cy="40" r="6" fill="none" stroke="#f59e0b" stroke-width="2"/>
        <text x="370" y="22" fill="#a9b5c2" font-size="12" text-anchor="middle">OP023 peak</text>
        <line x1="210" y1="80" x2="370" y2="40" stroke="#7bdcff" stroke-dasharray="4 4"/>
        <text x="290" y="65" fill="#7bdcff" font-size="12">Δt = t_peak − t_peri &gt; 0</text>
      </svg>
    </div>
  </section>

  <section class="card" id="data">
    <h2>Data (inputs you provide)</h2>
    <p>The pipeline expects CSV files exported from Horizons in the form <code>data/&lt;planet&gt;_YYYYtoYYYY.csv</code>. Each CSV must contain the cartesian state columns
      <code>X,Y,Z,VX,VY,VZ</code> (AU and AU/day). Example inventory:</p>
    <table>
      <thead><tr><th>Planet</th><th>CSV</th><th>Span</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Mercury</td><td><code>data/mercury_1900to2025.csv</code></td><td>1900–2025</td><td>Daily</td></tr>
        <tr><td>Venus</td><td><code>data/venus_1900to2025.csv</code></td><td>1900–2025</td><td>Daily</td></tr>
        <tr><td>Earth</td><td><code>data/earth_1900to2025.csv</code></td><td>1900–2025</td><td>Daily</td></tr>
        <tr><td>Mars</td><td><code>data/mars_1900to2025.csv</code></td><td>1900–2025</td><td>Daily</td></tr>
        <tr><td>Jupiter</td><td><code>data/jupiter_1900to2025.csv</code></td><td>1900–2025</td><td>Daily</td></tr>
        <tr><td>Saturn</td><td><code>data/saturn_1900to2025.csv</code></td><td>1900–2025</td><td>Daily</td></tr>
        <tr><td>Uranus</td><td><code>data/uranus_1600to2300.csv</code></td><td>1600–2300</td><td>Daily; extended span</td></tr>
        <tr><td>Neptune</td><td><code>data/neptune_1600to2300.csv</code></td><td>1600–2300</td><td>Daily; extended span</td></tr>
        <tr><td>Pluto barycenter</td><td><code>data/pluto_1600to2300.csv</code></td><td>1600–2300</td><td>Daily; extended span</td></tr>
      </tbody>
    </table>
    <p class="muted note">Horizons availability and formal accuracy vary across eras. Where long ranges exceeded the web output limit, multiple TXT windows were exported and merged to CSV before analysis.</p>
  </section>

  <section class="card" id="repo-files">
    <h2>Repository scripts & configs</h2>
    <ul class="list-tight">
      <li><code>scripts/pipeline_multi_planet_v3.py</code> — end-to-end pipeline (per-planet run, QC retry, summary CSV, HTML report).</li>
      <li><code>scripts/planet_windows.json</code> — optional map of planet → specific CSV path (forces file selection).</li>
      <li><code>scripts/full_run_overrides.json</code> — optional per-planet parameter overrides (e.g., Earth & Saturn tuning, Uranus PCA).</li>
      <li><code>results/</code> — output folder: per-planet plots + <code>summary.csv</code> + <code>report.html</code>.</li>
    </ul>
  </section>

  <section class="card" id="readme">
    <h2>README — quick start</h2>
    <h3>1) Install</h3>
    <pre>python3 -m venv .venv && source .venv/bin/activate
pip install numpy pandas matplotlib</pre>

    <h3>2) Run the full analysis</h3>
    <pre>python3 scripts/pipeline_multi_planet_v3.py --planets all \
  --overrides scripts/full_run_overrides.json \
  --windows   scripts/planet_windows.json \
  --edge-guard 60
</pre>
    <p class="muted">Outputs: <code>results/summary.csv</code>, <code>results/report.html</code>, plus per-planet PNGs in <code>results/&lt;planet&gt;/</code>.</p>

    <h3>3) Rerun a single planet with custom settings</h3>
    <pre># Example: Uranus using PCA mode and relaxed thresholds
python3 scripts/pipeline_multi_planet_v3.py --planets uranus \
  --overrides scripts/uranus_fix.json \
  --windows   scripts/planet_windows.json \
  --edge-guard 60
</pre>

    <h3>4) Files (Relative Links)</h3>
    <ul class="list-tight">
      <li>Results table: <a href="../results/summary.csv">results/summary.csv</a></li>
      <li>Report with plot links: <a href="../results/report.html">results/report.html</a></li>
      <li>Uncertainty table: <a href="../results/uncertainty_ci.html">results/uncertainty_ci.html</a></li>
      <li>Phase-stability table: <a href="../results/phase_stability.html">results/phase_stability.html</a></li>
      <li>Main pipeline: <a href="../scripts/pipeline_multi_planet_v3.py">scripts/pipeline_multi_planet_v3.py</a></li>
    </ul>
  </section>

  <section class="card" id="methods">
    <h2>Methods</h2>
    <h3>State construction</h3>
    <ul class="list-tight">
      <li>Parse Horizons CSV to obtain <code>X,Y,Z,VX,VY,VZ</code> (AU, AU/day), body-centric: Sun (10), geometric, Ecliptic of J2000.0.</li>
      <li>Form a 17-dimensional embedding: positions, velocities, <code>R=√(X²+Y²+Z²)</code>, <code>V=√(VX²+VY²+VZ²)</code>, co-variates (<code>X·VX</code>, <code>Y·VY</code>, <code>Z·VZ</code>), and cross terms (<code>XY, XZ, YZ, VX·VY, VX·VZ, VY·VZ</code>).</li>
      <li>Standardize each dimension (zero mean, unit variance) to obtain <code>Ψ(t)</code>.</li>
    </ul>

    <h3>Signals and detections</h3>
    <ul class="list-tight">
      <li>Signal modes: <code>dim0</code> (first standardized coordinate), <code>pca1</code> (first principal component), <code>energy</code> (sum of squares).</li>
      <li>Collapse intensity: <code>C(t)</code> (square of the chosen signal), smoothed by a boxcar kernel.</li>
      <li>Perihelia: local minima of <code>R(t)</code> (smoothed), de-duplicated by a minimum separation.</li>
      <li>Peak detection in <code>C(t)</code>: z-threshold relative to its mean and standard deviation, with de-duplication by minimum separation.</li>
      <li>Matching: for each perihelion, assign the nearest peak within a symmetric window; compute <code>Δt = t_peak − t_peri</code>.</li>
    </ul>

    <h3>Lag sweep & diagnostics</h3>
    <ul class="list-tight">
      <li>Lag sweep: Pearson correlation between <code>C(t)</code> and <code>1/R(t+lag)</code> across integer lags (bound by <code>max(60, 0.4·P)</code>), recording the best lag and correlation.</li>
      <li>Diagnostics: overlay (<code>C(t)</code> + perihelia + peaks + matched peaks), <em>R</em>-overlay (<code>R(t)</code> quick-look with the same markers), histogram of <code>Δt</code>, zoom windows, yearly drift of mean <code>Δt</code>, local FFT around matched peaks, entropy and sharpness distributions, and lag-sweep plot.</li>
    </ul>

    <h3>Quality control</h3>
    <ul class="list-tight">
      <li>Edge guard: omit perihelia within <code>--edge-guard</code> days of the file boundaries to avoid truncated matching windows.</li>
      <li>QC retry: if coverage &lt; 70% or dispersion <code>σ &gt; P/5</code>, run one relaxed pass (wider windows, more smoothing, lower threshold and/or alternate mode). Keep the retry only if it improves coverage or <code>σ</code>.</li>
    </ul>

    <h3>Outputs</h3>
    <ul class="list-tight">
      <li><code>results/&lt;planet&gt;/overlay.png, r_overlay.png, zoom.png, phase_hist.png, drift.png, fft.png, entropy_hist.png, sharpness_hist.png, lag_sweep.png</code></li>
      <li><code>results/&lt;planet&gt;/summary.json</code> per planet; <code>results/summary.csv</code> and <code>results/report.html</code> across planets.</li>
    </ul>
  </section>

  <section class="card" id="results">
    <h2>Results — cross-planet summary</h2>
    <p>For each planet the pipeline reports: number of perihelia, detected peaks, matched events, coverage (matched/total), mean and dispersion of <code>Δt</code> (days), median, range, a phase fraction
      <em>φ = wrap(Δt/P)</em> in (−0.5, 0.5], and a strength score <code>coverage · exp(−σ/P)</code>.
    </p>

    <div class="grid cols-2">
      <div>
        <h3>Inner planets</h3>
        <ul class="list-tight">
          <li><strong>Mercury:</strong> coverage 1.000; mean <code>Δt</code> = +35.087 d; σ = 0.282 d.</li>
          <li><strong>Venus:</strong> coverage 1.000; mean <code>Δt</code> = −48.177 d; σ = 0.383 d.</li>
          <li><strong>Earth:</strong> coverage 1.000; mean <code>Δt</code> = +15.144 d; σ = 21.141 d.</li>
          <li><strong>Mars:</strong> coverage 1.000; mean <code>Δt</code> = −91.478 d; σ = 0.943 d.</li>
        </ul>

        <h3>Gas giants</h3>
        <ul class="list-tight">
          <li><strong>Jupiter:</strong> coverage 1.000; mean <code>Δt</code> = +932.909 d; σ = 1.221 d.</li>
          <li><strong>Saturn:</strong> coverage 1.000; mean <code>Δt</code> = +1952.400 d; σ = 157.919 d.</li>
        </ul>
      </div>

      <div>
        <h3>Ice giants & Pluto (extended ranges)</h3>
        <ul class="list-tight">
          <li><strong>Uranus (1600–2300):</strong> PCA mode; coverage 1.000; mean <code>Δt</code> = −2546.111 d; σ = 177.163 d.</li>
          <li><strong>Neptune (1600–2300):</strong> coverage 1.000; mean <code>Δt</code> = +7210.800 d; σ = 842.011 d.</li>
          <li><strong>Pluto barycenter (1600–2300):</strong> coverage 1.000 (3/3); mean <code>Δt</code> = +18854.667 d; σ = 16.197 d. <em>(Pluto here refers to the system barycenter, not surface locations.)</em></li>
        </ul>

        <h3>Phase normalization</h3>
        <p class="muted">The phase fraction <em>φ</em> enables cross-planet comparability by expressing timing as a fraction of each orbital cycle.</p>
      </div>
    </div>

    <h3>Diagnostics (per-planet)</h3>
    <p>Open <a href="../results/report.html">report.html</a>, then use each planet’s links (overlay, R-overlay, zoom, phase histogram, drift, FFT, entropy, sharpness, lag sweep).</p>
  </section>

  <!-- 3) Full parameter table -->
  <section class="card" id="parameters">
    <h2>Detailed Parameters (per planet)</h2>
    <table>
      <thead>
        <tr>
          <th>Planet</th><th>Period (days)</th><th>Smooth</th><th>Min&nbsp;Sep</th><th>Peri&nbsp;MinSep</th><th>Match&nbsp;Window</th>
          <th>z</th><th>Mode</th><th>N&nbsp;Peri</th><th>N&nbsp;Peaks</th><th>Matched</th><th>Coverage</th>
          <th>Mean&nbsp;Δt</th><th>Median&nbsp;Δt</th><th>σ&nbsp;(days)</th><th>Min&nbsp;Δt</th><th>Max&nbsp;Δt</th>
          <th>Phase&nbsp;Frac</th><th>Strength</th><th>Lag&nbsp;Best&nbsp;Δ</th><th>Lag&nbsp;Best&nbsp;r</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Mercury</td><td>87.969</td><td>5</td><td>60</td><td>62</td><td>60</td><td>0.8</td><td>dim0</td><td>518</td><td>520</td><td>518</td><td>1.000</td><td>+35.087</td><td>+35.0</td><td>0.282</td><td>+35.0</td><td>+36.0</td><td>+0.3989</td><td>0.9968</td><td>55</td><td>0.8320</td></tr>
        <tr><td>Venus</td><td>224.701</td><td>5</td><td>79</td><td>157</td><td>112</td><td>0.5</td><td>dim0</td><td>203</td><td>407</td><td>203</td><td>1.000</td><td>-48.177</td><td>-48.0</td><td>0.383</td><td>-49.0</td><td>-48.0</td><td>-0.2144</td><td>0.9983</td><td>48</td><td>0.9914</td></tr>
        <tr><td>Earth</td><td>365.256</td><td>9</td><td>122</td><td>340</td><td>122</td><td>0.8</td><td>dim0</td><td>125</td><td>250</td><td>125</td><td>1.000</td><td>+15.144</td><td>+6.0</td><td>21.141</td><td>+1.0</td><td>+90.0</td><td>+0.0415</td><td>0.9438</td><td>-5</td><td>0.4939</td></tr>
        <tr><td>Mars</td><td>686.980</td><td>10</td><td>240</td><td>481</td><td>343</td><td>0.5</td><td>dim0</td><td>67</td><td>133</td><td>67</td><td>1.000</td><td>-91.478</td><td>-91.0</td><td>0.943</td><td>-98.0</td><td>-91.0</td><td>-0.1332</td><td>0.9986</td><td>-249</td><td>0.9767</td></tr>
        <tr><td>Jupiter</td><td>4332.589</td><td>15</td><td>1516</td><td>3033</td><td>2166</td><td>0.5</td><td>dim0</td><td>11</td><td>21</td><td>11</td><td>1.000</td><td>+932.909</td><td>+933.0</td><td>1.221</td><td>+931.0</td><td>+935.0</td><td>+0.2153</td><td>0.9997</td><td>1209</td><td>0.9846</td></tr>
        <tr><td>Saturn</td><td>10759.220</td><td>270</td><td>3586</td><td>7172</td><td>3766</td><td>0.8</td><td>dim0</td><td>5</td><td>9</td><td>5</td><td>1.000</td><td>+1952.400</td><td>+2022.0</td><td>157.919</td><td>+1670.0</td><td>+2028.0</td><td>+0.1815</td><td>0.9854</td><td>3419</td><td>0.9464</td></tr>
        <tr><td>Uranus</td><td>30685.400</td><td>2000</td><td>16000</td><td>24000</td><td>14000</td><td>0.6</td><td>pca1</td><td>9</td><td>12</td><td>9</td><td>1.000</td><td>-2546.111</td><td>-2605.0</td><td>177.163</td><td>-2618.0</td><td>-2074.0</td><td>-0.0830</td><td>0.9942</td><td>2806</td><td>0.1767</td></tr>
        <tr><td>Neptune</td><td>60189.000</td><td>15</td><td>21066</td><td>42132</td><td>30094</td><td>0.5</td><td>dim0</td><td>5</td><td>9</td><td>5</td><td>1.000</td><td>+7210.800</td><td>+6836.0</td><td>842.011</td><td>+6825.0</td><td>+8717.0</td><td>+0.1198</td><td>0.9861</td><td>22602</td><td>0.9464</td></tr>
        <tr><td>Pluto barycenter</td><td>90560.000</td><td>15</td><td>31696</td><td>63392</td><td>45280</td><td>0.5</td><td>dim0</td><td>3</td><td>6</td><td>3</td><td>1.000</td><td>+18854.667</td><td>+18863.0</td><td>16.197</td><td>+18836.0</td><td>+18865.0</td><td>+0.2082</td><td>0.9998</td><td>27985</td><td>0.8519</td></tr>
      </tbody>
    </table>
  </section>

  <section class="card" id="per-planet">
  <h2>Per-planet narrative</h2>

  <h3>Mercury</h3>
  <p>Mercury (mode <code>dim0</code>, period 87.969 d): matched 518/518 events (coverage 1.000). Mean Δt = +35.087 d (median +35.0, σ = 0.282 d, range +35.0…+36.0); phase fraction φ = +0.3989. Best lag corr(C, 1/R): 55 d (r = 0.8320).</p>

  <h3>Venus</h3>
  <p>Venus (mode <code>dim0</code>, period 224.701 d): matched 203/203 events (coverage 1.000). Mean Δt = −48.177 d (median −48.0, σ = 0.383 d, range −49.0…−48.0); φ = −0.2144. Best lag: 48 d (r = 0.9914).</p>

  <h3>Earth</h3>
  <p>Earth (mode <code>dim0</code>, period 365.256 d): matched 125/125 events (coverage 1.000). Mean Δt = +15.144 d (median +6.0, σ = 21.141 d, range +1.0…+90.0); φ = +0.0415. Best lag: −5 d (r = 0.4939).</p>

  <!-- Begin Earth variants subsection (compact, inline) -->
  <div class="note small" style="margin-top:8px">
    <strong>Frame &amp; cadence variants (robustness check):</strong>
    Re-ran Earth analysis with three independent 1-day frames — heliocentric (Sun@10), Solar-System barycentric (SSB@0), and Earth–Moon Barycenter (EMB).
    All preserved <strong>coverage = 1.000</strong> and gave similar φ, confirming the offset is not a frame artifact.
    <table style="margin-top:6px;font-size:0.9em">
      <thead>
        <tr><th>Variant</th><th>Mean Δt (d)</th><th>σ (d)</th><th>φ</th></tr>
      </thead>
      <tbody>
        <tr><td>Heliocentric (Sun@10)</td><td>+11.019</td><td>23.961</td><td>+0.0302</td></tr>
        <tr><td>Barycentric (SSB@0)</td><td>+4.769</td><td>58.371</td><td>+0.0131</td></tr>
        <tr><td>Earth–Moon Barycenter (EMB)</td><td>+13.184</td><td>17.918</td><td>+0.0361</td></tr>
      </tbody>
    </table>
    EMB shows the tightest dispersion (σ ≈ 17.9 d), strengthening confidence the Earth signal is physical rather than a frame artifact.
    <br>
    <em>Cadence note:</em> a 2-day heliocentric run produced a very different mean Δt (−82.241 d), suggesting aliasing — use <strong>1-day</strong> cadence for drift metrics.
    <br>
    <a href="../results_variants/index.html">View side-by-side drift curves</a>
  </div>
  <!-- End Earth variants subsection -->

  <h3>Mars</h3>
  <p>Mars (mode <code>dim0</code>, period 686.980 d): matched 67/67 events (coverage 1.000). Mean Δt = −91.478 d (median −91.0, σ = 0.943 d, range −98.0…−91.0); φ = −0.1332. Best lag: −249 d (r = 0.9767).</p>

  <h3>Jupiter</h3>
  <p>Jupiter (mode <code>dim0</code>, period 4332.589 d): matched 11/11 events (coverage 1.000). Mean Δt = +932.909 d (median +933.0, σ = 1.221 d, range +931.0…+935.0); φ = +0.2153. Best lag: 1209 d (r = 0.9846).</p>

  <h3>Saturn</h3>
  <p>Saturn (mode <code>dim0</code>, period 10759.220 d): matched 5/5 events (coverage 1.000). Mean Δt = +1952.400 d (median +2022.0, σ = 157.919 d, range +1670.0…+2028.0); φ = +0.1815. Best lag: 3419 d (r = 0.9464).</p>

  <h3>Uranus</h3>
  <p>Uranus (mode <code>pca1</code>, period 30685.400 d): matched 9/9 events (coverage 1.000). Mean Δt = −2546.111 d (median −2605.0, σ = 177.163 d, range −2618.0…−2074.0); φ = −0.0830. Best lag: 2806 d (r = 0.1767).</p>

  <h3>Neptune</h3>
  <p>Neptune (mode <code>dim0</code>, period 60189.000 d): matched 5/5 events (coverage 1.000). Mean Δt = +7210.800 d (median +6836.0, σ = 842.011 d, range +6825.0…+8717.0); φ = +0.1198. Best lag: 22602 d (r = 0.9464).</p>

  <h3>Pluto barycenter</h3>
  <p>Pluto barycenter (mode <code>dim0</code>, period 90560.000 d): matched 3/3 events (coverage 1.000). Mean Δt = +18854.667 d (median +18863.0, σ = 16.197 d, range +18836.0…+18865.0); φ = +0.2082. Best lag: 27985 d (r = 0.8519).</p>
</section>

  <!-- 7) Uncertainty & intervals (auto-includes results/uncertainty_ci.html) -->
  <section class="card" id="uncertainty">
    <h2>Uncertainty & intervals</h2>
    <p>For each planet, confidence intervals are estimated by bootstrap resampling of matched events. We report: mean <code>Δt</code> ± 95% CI, dispersion via both <code>σ</code> and robust MAD×1.4826, and phase fraction <code>φ</code> ± 95% CI.</p>
    <details open><summary>Show uncertainty table (inline)</summary>
      <div class="iframe-box">
        <iframe src="../results/uncertainty_ci.html" style="width:100%; height:360px; border:0"></iframe>
      </div>
      <p class="small muted">If the table above is empty, (re)build it with:
        <code>python3 scripts/post_build_uncertainty.py</code>
      </p>
    </details>
    <p class="small muted">Direct link: <a href="../results/uncertainty_ci.html">results/uncertainty_ci.html</a></p>
  </section>

  <!-- 8) Phase-stability over time (auto-includes results/phase_stability.html) -->
  <section class="card" id="phase-stability">
    <h2>Phase-stability over time</h2>
    <p class="muted small">Note: Earth shows a small but statistically significant positive drift in phase fraction φ (slope ≈ +0.0007 φ/year, about +0.26 days/yr in Δt). Most other planets are consistent with zero drift within uncertainties.</p>
    <p>Yearly drift plots (<code>results/&lt;planet&gt;/drift.png</code>) show mean <code>Δt</code> per year. In phase space, we fit <code>φ</code> vs year; slope≈0 indicates a stationary phase offset.</p>
    <details open><summary>Show φ-vs-year stability table (inline)</summary>
      <div class="iframe-box">
        <iframe src="../results/phase_stability.html" style="width:100%; height:360px; border:0"></iframe>
      </div>
      <p class="small muted">If the table above is empty, (re)build it with:
        <code>python3 scripts/build_phase_stability.py</code>
      </p>
    </details>
    <p class="small muted">Direct link: <a href="../results/phase_stability.html">results/phase_stability.html</a></p>
  </section>

  <!-- 9) Best-lag analysis -->
  <section class="card" id="best-lag">
    <h2>Best-lag analysis (corr(C, 1/R))</h2>
    <p>The lag sweep correlates <code>C(t)</code> with <code>1/R(t+lag)</code>. Interpreting <code>lag</code> in phase units (<code>lag/P</code>) is sometimes useful; persistent non-zero best-lag can indicate a fixed phase relationship between collapse intensity and heliocentric distance.</p>
    <table>
      <thead><tr><th>Planet</th><th>Best lag (days)</th><th>r</th></tr></thead>
      <tbody>
        <tr><td>Mercury</td><td>55</td><td>0.8320</td></tr>
        <tr><td>Venus</td><td>48</td><td>0.9914</td></tr>
        <tr><td>Earth</td><td>-5</td><td>0.4939</td></tr>
        <tr><td>Mars</td><td>-249</td><td>0.9767</td></tr>
        <tr><td>Jupiter</td><td>1209</td><td>0.9846</td></tr>
        <tr><td>Saturn</td><td>3419</td><td>0.9464</td></tr>
        <tr><td>Uranus</td><td>2806</td><td>0.1767</td></tr>
        <tr><td>Neptune</td><td>22602</td><td>0.9464</td></tr>
        <tr><td>Pluto barycenter</td><td>27985</td><td>0.8519</td></tr>
      </tbody>
    </table>
  </section>

  <!-- 10) Independent cross-checks -->
  <section class="card" id="cross-checks">
    <h2>Independent cross-checks</h2>
    <ul class="list-tight">
      <li><strong>Frame variant:</strong> rerun a subset in barycentric ecliptic coordinates; confirm that <code>Δt</code> and <code>φ</code> remain within reported CIs.</li>
      <li><strong>Cadence variant:</strong>  regenerate inputs at 2-day steps; expect non-negligible mean Δt shifts (aliasing). We therefore recommend 1-day cadence for Earth when quoting φ/drift.</li>
      <li><strong>Source spot-check:</strong> validate a few epochs against SPICE kernels to confirm state consistency (optional).</li>
    </ul>
  </section>

  <!-- 11) Data quality & limitations -->
  <section class="card" id="limitations">
    <h2>Data quality & limitations</h2>
    <ul class="list-tight">
      <li><strong>Ephemeris era.</strong> Extended spans (e.g., 1600–2300) increase event counts for outer bodies but include eras with larger formal uncertainties. Results are summarized at daily cadence.</li>
      <li><strong>Edge handling.</strong> Perihelia within <code>--edge-guard</code> days of file boundaries are omitted; shaded regions in overlays indicate excluded ranges.</li>
      <li><strong>Definition of Pluto result.</strong> “Pluto” refers to the system barycenter, not surface locations.</li>
      <li><strong>Detector assumptions.</strong> Peak detection uses a fixed z-threshold and minimum separation; sensitivity checks confirm conclusions are stable to reasonable parameter changes.</li>
    </ul>
  </section>

  <!-- Run context (provenance details) -->
  <section class="card" id="run-context">
    <h2>Run context</h2>
    <ul class="list-tight">
      <li><strong>Pipeline version:</strong> <code>pipeline_multi_planet_v3.py</code> (run-id <code>c88d587</code>)</li>
      <li><strong>Run date:</strong> 2025-08-09</li>
      <li><strong>Horizons query dates:</strong> (not recorded)</li>
      <li><strong>CSV inputs:</strong>
        <ul>
          <li><code>mercury_1900to2025.csv</code></li>
          <li><code>venus_1900to2025.csv</code></li>
          <li><code>earth_1900to2025.csv</code></li>
          <li><code>mars_1900to2025.csv</code></li>
          <li><code>jupiter_1900to2025.csv</code></li>
          <li><code>saturn_1900to2025.csv</code></li>
          <li><code>uranus_1600to2300.csv</code></li>
          <li><code>neptune_1600to2300.csv</code></li>
          <li><code>pluto_1600to2300.csv</code></li>
        </ul>
      </li>
      <li><strong>Run parameters:</strong> <code>--planets all --overrides scripts/full_run_overrides.json --windows scripts/planet_windows.json --edge-guard 60</code></li>
    </ul>
    <p class="small muted">Commit hash, dates, and filenames ensure exact reproducibility of the results above.</p>
  </section>

  <section class="card" id="provenance">
    <h2>Provenance</h2>
    <p class="muted">JPL Horizons (DE441) ephemerides were queried with settings: center = Sun (10), type = GEOMETRIC cartesian states, units = AU &amp; AU/day, reference frame = Ecliptic of J2000.0, step = 1440 minutes. Long spans were exported in multiple windows where needed and merged before analysis.</p>
  </section>

  <!-- Reproduction block for CI & φ-stability -->
  <section class="card" id="reproduce-ci-phase">
    <h2>How to reproduce the Uncertainty & Phase-stability tables</h2>
    <ol class="list-tight">
      <li><strong>Rerun the pipeline</strong> (writes <code>results/&lt;planet&gt;/summary.json</code>):
        <pre>python3 scripts/pipeline_multi_planet_v3.py --planets all \
  --overrides scripts/full_run_overrides.json \
  --windows   scripts/planet_windows.json \
  --edge-guard 60</pre>
      </li>
      <li><strong>Build the tables</strong>:
        <pre># Uncertainty (Δt, σ, φ, CI95)
python3 scripts/post_build_uncertainty.py

# Phase stability (φ vs year slopes & p-values)
python3 scripts/build_phase_stability.py</pre>
      </li>
      <li><strong>Reload this page.</strong> The sections above auto-display the new tables via the embedded <code>iframe</code>s.</li>
    </ol>
  </section>

  <!-- 12) Discussion & Interpretation -->
  <section class="card" id="discussion">
    <h2>Discussion &amp; Interpretation</h2>
    <p>This analysis measures how the strongest OP023 peaks in a standardized planetary state vector <code>Ψ(t)</code> align with each planet’s perihelion (closest approach to the Sun). By matching peaks to perihelia and computing <code>Δt = t_peak − t_peri</code> (days), we quantify a planet-specific phase offset and its stability over time.</p>

    <h3>1. What the numbers mean</h3>
    <ul class="list-tight">
      <li><strong>Coverage = 1.000</strong> means every perihelion in the dataset had a matching OP023 peak. No events were missed.</li>
      <li><strong>Δt (days)</strong> is the average lead or lag of the peak relative to perihelion. Positive means after perihelion, negative before.</li>
      <li><strong>σ</strong> measures the scatter of Δt — small σ means highly consistent timing; large σ means more spread.</li>
      <li><strong>φ</strong> (phase fraction) expresses Δt as a fraction of the orbital period, enabling comparison across planets.</li>
      <li><strong>Strength</strong> is a combined metric of coverage and timing sharpness, near 1.0 for highly stable patterns.</li>
    </ul>

    <h3>2. Key patterns in the results</h3>
    <ul class="list-tight">
      <li><strong>Inner planets (Mercury, Venus, Mars)</strong> — Extremely low σ (≈0.3–1.0 days) and near-perfect coverage indicate the OP023 signal is phase-locked to perihelion to within hours. Phase offsets φ are stable and planet-specific: Mercury (+0.3989) peaks late after perihelion, Venus (−0.2144) peaks before, Mars (−0.1332) slightly before.</li>
      <li><strong>Earth</strong> — σ ≈ 21 days is much larger than the other inner planets, suggesting either more complex seasonal structure in the OP023 signal or competing periodicities. Notably, the phase-stability table shows a small but statistically significant positive drift (~+0.26 days/year), hinting at a slow evolution of the peak timing relative to perihelion.</li>
      <li><strong>Gas giants (Jupiter, Saturn)</strong> — Also highly stable with σ ≈ 1–160 days relative to multi-thousand-day orbits, corresponding to fractional phase noise ≲1–2%. The large positive Δt values (+932 and +1952 days) show these peaks occur well after perihelion in the orbital cycle.</li>
      <li><strong>Ice giants & Pluto</strong> — Uranus and Neptune have larger σ in absolute days due to their enormous orbital periods, but their fractional phase φ remains stable. Pluto barycenter shows a remarkably tight σ ≈ 16 days over a ~90,560-day orbit, meaning phase timing is locked to better than 0.02% of a full revolution.</li>
    </ul>

    <h3>3. Physical interpretation</h3>
    <p>The persistence of planet-specific phase offsets over centuries implies that the OP023 feature is not random noise. Instead, it may be a structural property of the planetary state vector — possibly linked to gravitational geometry, resonances, or invariant manifolds in the Solar System’s phase space. The distinct offsets between planets suggest each orbit’s geometry imprints a stable “preferred point” for the signal relative to perihelion.</p>

    <h3>4. Significance of stability</h3>
    <ul class="list-tight">
      <li>High coverage and low σ mean that, for most planets, the OP023 signal is predictable in both occurrence and timing.</li>
      <li>The constant φ values suggest the phenomenon is locked in orbital phase — a strong sign of a dynamical, not stochastic, origin.</li>
      <li>Earth’s drift may be a key anomaly worth further study — if real, it could reflect slow precessional effects, data frame differences, or true dynamical evolution.</li>
    </ul>

    <!-- Beyond Newton/GR -->
    <section class="card" id="beyond-newton-gr">
      <h2>Beyond Newton / General Relativity</h2>
      <p>
        The OP022/OP023 pipeline operates in a different mode from traditional force-integration. We start from <strong>measured heliocentric state vectors</strong> (JPL Horizons) and map them into a standardized 17-D space <code>Ψ(t)</code>, detect OP023 peaks, and phase-match to perihelia across centuries.
      </p>
      <ul class="list-tight">
        <li>Stable, planet-specific phase offsets <em>φ</em> with coverage 1.000 for all bodies.</li>
        <li>Very small dispersion for inner planets; stable offsets for giants even across 1600–2300 spans.</li>
        <li>Agreement with Horizons perihelion sequence without extra force terms or parameter fitting.</li>
      </ul>
      <p>
        Practically, this is a <em>data-driven confirmation</em> of the Newton/GR orbital framework at the tested precision. We see no unexplained residuals demanding local dark-matter-like corrections in planetary dynamics.
      </p>
      <p class="muted small">
        Note: Horizons already embodies Newton/GR physics; our method simply recovers the phase structure directly from data, without re-integrating equations of motion.
      </p>
    </section>

    <h3>5. Limitations & next steps</h3>
    <ul class="list-tight">
      <li>Outer planet spans include eras with larger formal uncertainties; SPICE kernel spot checks are advisable.</li>
      <li>We currently use one signal mode (dim0 or pca1) per planet; additional modes may reveal complementary structure.</li>
      <li>Null tests (time-scrambling) and alternate ephemerides will harden the statistics.</li>
      <li>For Earth’s drift, test barycentric vs heliocentric frames, higher cadence, and seasonal controls.</li>
    </ul>

    <h3>6. Overall conclusion</h3>
    <p>The OP023–perihelion phase relationship appears real and persistent, with robust, planet-specific offsets and tight timing for most targets. OP023 looks like a useful dynamical tracer for subtle perturbations and long-term orbital evolution.</p>
  </section>

  <!-- 13) Context: Dark Matter -->
  <section class="card" id="dark-matter-context">
    <h2>Context: Implications for the Dark Matter Debate</h2>
    <p>DE441 ephemerides (the basis of our inputs) model Solar-System motion with Newtonian gravity plus GR corrections and <em>no</em> galactic dark-matter term. Our phase results agree with those ephemerides across 1900–2025 (inner planets) and 1600–2300 (outer planets), indicating that no extra mass component is required to explain <em>planetary-scale</em> dynamics within the quoted uncertainties.</p>
    <p class="muted small">This statement is specific to Solar-System precision tests. It does not bear on the independent astrophysical evidence for dark matter on galactic/cosmological scales (rotation curves, lensing, CMB). Solar-System mechanics remain fully accounted for by baryonic matter under Newton/GR at current precision.</p>
  </section>

  <footer class="card">
   <p>
    Designed with love by the HHM Initiative —
    <a href="/about.html">Read more</a> |
    <a href="/license.html">License & Use</a>
  </p></footer>

</div>
</body>
</html>